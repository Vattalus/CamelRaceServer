function generateFailObj(a,b){return{Result:"Failed",Message:a,Data:b}}function generateErrObj(a,b){return{Result:"Error",Message:a,Data:b}}function loadTitleDataJson(a){var b=server.GetTitleData({PlayFabId:currentPlayerId,Keys:[a]});if(void 0==b||void 0==b.Data||void 0==b.Data[a])return null;a=JSON.parse(b.Data[a]);return void 0==a?null:a}function randomRange(a,b){return Math.round(Math.random()*(Number(b)-Number(a)))+Number(a)}
function addCurrency(a,b){server.AddUserVirtualCurrency({PlayFabId:currentPlayerId,VirtualCurrency:a,Amount:b})}
handlers.grantOasis=function(a,b){a=loadTitleDataJson("Balancing_Oasis");if(void 0==a||null==a)return generateErrObj("Oasis Balancing JSON undefined or null");var c=server.GetUserReadOnlyData({PlayFabId:currentPlayerId,Keys:["nextOasis"]});b=new Date;if(void 0!=c.Data.nextOasis&&void 0!=c.Data.nextOasis.Value&&c.Data.nextOasis.Value>=b.getTime())return generateFailObj("Oasis not ready yet",c.Data.nextOasis.Value);var c=randomRange(a.scRewardBase,2*a.scRewardBase),d=randomRange(a.hcRewardMin,a.hcRewardMax),
e=randomRange(a.ticketsRewardMin,a.ticketsRewardMax);addCurrency("SC",c);addCurrency("HC",d);addCurrency("TK",e);a=b.getTime()+Number(a.rechargeInterval);server.UpdateUserReadOnlyData({PlayFabId:currentPlayerId,Data:{nextOasis:a}});b=server.GetUserInventory({PlayFabId:currentPlayerId}).VirtualCurrency;return{nextOasisTimestamp:a,VirtualCurrency:b}};
