function generateFailObj(b,a){return{Result:"Failed",Message:b,Data:a}}function generateErrObj(b,a){return{Result:"Error",Message:b,Data:a}}function loadTitleDataJson(b){var a=server.GetTitleData({PlayFabId:currentPlayerId,Keys:[b]});if(void 0==a||void 0==a.Data||void 0==a.Data[b])return null;b=JSON.parse(a.Data[b]);return void 0==b?null:b}function randomRange(b,a){return Math.round(Math.random()*(a-b))+b}
handlers.grantOasis=function(b,a){a=loadTitleDataJson("Balancing_Oasis");if(void 0==a||null==a)return generateErrObj("Oasis Balancing JSON undefined or null");b=server.GetUserReadOnlyData({PlayFabId:currentPlayerId,Keys:["nextOasis"]});var c=new Date;if(void 0!=b.Data.nextOasis&&void 0!=b.Data.nextOasis.Value&&b.Data.nextOasis.Value>=c.getTime())return generateFailObj("Oasis not ready yet",b.Data.nextOasis.Value);log.debug("sc reward: ",randomRange(a.scRewardBase,2*a.scRewardBase));log.debug("hc reward: ",
randomRange(a.hcRewardMin,a.hcRewardMax));log.debug("tk reward: ",randomRange(a.ticketsRewardMin,a.ticketsRewardMax));a=c.getTime()+Number(a.rechargeInterval);server.UpdateUserReadOnlyData({PlayFabId:currentPlayerId,Data:{nextOasis:a}});return{nextOasisTimestamp:b.Data.nextOasis}};
